#!/bin/sh
# Commit message validation hook for AgentForge

commit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|ci)(\(.+\))?: .{1,50}'

if ! grep -qE "$commit_regex" "$1"; then
    echo "❌ Invalid commit message format"
    echo ""
    echo "Format: <type>(<scope>): <subject>"
    echo ""
    echo "Types: feat, fix, docs, style, refactor, test, chore, perf, ci"
    echo "Example: feat(tui): add prompt optimization feature"
    echo ""
    echo "Your commit message:"
    cat "$1"
    echo ""
    exit 1
fi

# Check for conventional commit format
if ! head -n 1 "$1" | grep -qE '^(feat|fix|docs|style|refactor|test|chore|perf|ci)(\(.+\))?: .+'; then
    echo "❌ Commit message must follow conventional commit format"
    exit 1
fi

echo "✅ Commit message format is valid"